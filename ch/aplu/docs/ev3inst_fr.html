<html>
<head>
</head>
<body font face="Arial, Helvetica, sans-serif">
<blockquote>
  <h2><a href="http://ch/aplu/docs/index_fr.html"><img src="gifs/home.png" alt="home" width="25" height="25"></a></h2>
  <h2>EV3 Installation</h2>
  <h3>1 <strong> Create the leJOS bootable SD card</strong></h3>
  <p>By   default the EV3 bricks starts the Lego menu application. To get access   to the Linux file system and execute Python scripts or Java byte code, it is necessary to   configure a special SD card and insert it into the SD card slot. If the   card present, the EV3 boots the leJOS menu application instead of the   Lego menu. If you remove the card, the brick starts again with the Lego   menu. Proceed as follows to create the leJOS SD card:</p>
</blockquote>
<ul>
  <li>Provide an empty Micro SD card with minimum 4 GB and maximum 32 GB</li>
  <li>Insert the card into a card reader</li>
  <li>A new SD card contains normally a single empty FAT32 primary partition. If your card was already in use, you should check with a disk management tool, if the card is<strong> FAT32</strong> formatted and contains a single empty  <strong>primary</strong> partition.  (A card already used for   leJOS contains a 500 MB FAT partition. The remaining space is Ext2   formatted and contains the Linux file system. Under Windows the free   MiniTool Partition Home Edition is a good choice to remove all   partitions and create a single FAT32 primary partition.)<br>
  </li>
  <li>Download the file <a href="http://clab2.phbern.ch/lego/EV3Autonom/download/ev3sdcard.zip">ev3sdcard.zip</a> (approx. 70 MB), unpack it and copy all files and directories to the SD card. You must see the following files:</li>
  </ul>
<blockquote>
  <p align="center"><img src="gifs/sdcard2.png" alt="" width="455" height="168" border="1"><br>
      <br>
  </p>
  <h3>2 Boot  EV3 with leJOS</h3>
</blockquote>
<ul>
  <li>Insert the SD card into the EV3 card slot (labeling upside) and press the turn-on button</li>
  <li>After a short while the leJOS   start screen is displayed. If instead the Lego menu is shown, you did   not properly configure the SD card. Check if the partition is 4 - 32 MB   FAT32 (primary) and if all files/directories are present</li>
  <li>Now the SD card is   automatically repartitioned. This may last some 20 minutes, so be   patient. After the initializing process the EV3 emits a sound and   displays the leJOS menu. From now on, you let the SD card inserted in the card slot</li>
  <li>Turn the EV3 off and reboot it. It now starts much faster.</li>
</ul>
<br>

<blockquote>
  <h3>3 <strong>Connect to the EV3</strong> </h3>
  <p align="justify">All connections   to the EV3 use the TCP/IP protocol, but the physical transport channel   may be USB, Bluetooth or WLAN. When booted with leJOS, a Linux Secure   Shell (SSH) server with Secure Copy (SCP)   is started   (but no SFTP server). The EV3 replies also to ping requests. Ping is the   easiest way to check if the IP link to the EV3 is working. The default   IP address (for Bluetooth and USB) is 10.0.1.1 as seen on the leJOS start screen.</p>
  <p align="justify">You may connect your PC via USB, Bluetooth or WLAN. Bluetooth  is the <strong>recommended connection method</strong> because you don't need a cable nor a WLAN adapter. (<a href="http://www.aplu.ch/home/ev3_inst.html">Consult</a> the APLU site to get information how to connect via USB or WLAN). The Bluetooth   Personal Area Network (PAN) protocol is used to establish an IP   connection via Bluetooth. </p>
  <div align="justify">
    <p>To enable IP over Bluetooth, the EV3 must act as PAN server. Proceed as follows:</p>
    <table border="0" width="906">
      <tbody>
        <tr>
          <td valign="top" width="605"><strong>Bluetooth PAN under Windows</strong>:<br>
              <br>
              
            <ul>
              <li>After the pairing is performed (and <strong>each time the EV3 is turned on</strong>), the EV3 must be made active as IP Access Point. In <em>Devices and Printers</em> right click the EV3 symbol and select "Connect using &gt; Access point". </li>
            </ul></td>
          <td valign="top" width="291"><img src="gifs/ev3bluetooth1.png" alt="ev3ndis1" height="136" width="287"></td>
        </tr>
      </tbody>
    </table>
    </div>
  <div align="justify">
    <table border="0" width="906">
      <tbody>
        <tr>
          <td valign="top" width="628"><strong>Bluetooth PAN under Linux (Ubuntu)</strong>:<br>
              <br>
              
            <ul>
              <li>In the Bluetooth Setting you must enable the checkbox "Use your mobile phone as a network device (PAN/NAP)"</li>
              </ul></td>
          <td valign="top" width="268"><img src="gifs/ev3_pan_linux2.png" alt="ev3_pan_linux" height="85" width="435"></td>
        </tr>
      </tbody>
    </table>
    <table border="0" width="906">
      <tbody>
        <tr>
          <td valign="top"><br>
              
            <ul>
              <li>After the pairing is performed (and <strong>each time the EV3 is turned on</strong>), the EV3 must be made active as IP Access Point. In the <em>Network Icon Menu</em> click the <em>EV3&nbsp;Network</em>. After a while a confirmation box is shown.</li>
              </ul></td>
          <td valign="top"><img src="gifs/ev3_pan_linux1.png" alt="ev3_pan_linux" height="232" width="290"></td>
        </tr>
        <tr>
          <td valign="top" width="628"><strong>Bluetooth PAN under MacOS:</strong><br>
              <br>
              
            <ul>
              <li>Click   the Bluetooth icon and perform a Bluetooth device search. Pair the EV3   while ignoring the passkey. In the Bluetooth control panel the EV3* will   be shown as <em>not connected</em>.<br>
                  <br>
              </li>
              <li>Click the Bluetooth icon and move the cursor to the EV3 entry. Select the <em>"Connect to network"</em> option.</li>
            </ul>
            <p><img src="gifs/btmac6.png" alt="bluetooth_mac" width="500" height="229"></p>
            </td>
          <td valign="top" width="268"><p>&nbsp;</p>
              <p>&nbsp;</p></td>
        </tr>
      </tbody>
    </table>
  </div>
  <p align="justify">You can <strong>change</strong> the robots<strong> friendly Bluetooth name</strong> in the EV3 menu under <em>System - Change name.</em> To enter a new name, move the cursor block using the cursor keys.   Confirm each letter by pressing Enter. The new name is displayed at the   bottom of the screen. (The letter U stands for uppercase, l for   lowercase, X for delete and D for done.) To finish the modification,   move to D and press Enter. Then <strong>reboot</strong> the EV3 to make the name active.  There is no other action needed on the EV3 to establish the IP   connectivity over Bluetooth.</p>
  <h3 align="justify">4 <strong>Start/Update the BrickGate</strong> server</h3>
</blockquote>
<blockquote>
  <p align="justify"> Python scripts  executed on the remote PC or locally under the EV3 Python interpreter access the Lego hardware via <em>BrickGate</em>, a TCP/IP gateway running on the EV3. <em>BrickGate</em> is started from the leJOS menu like any other leJOS program. It's main purpose is to interpret commands from   a Python client, but it also displays a menu to start Python scripts autonomously.<em>BrickGate</em> is part of the SD card distribution. If you make it the <em>Default Program</em>, it can be  started with one click each time the EV3 boots.</p>
  <p align="justify">If accidently you delete the BrickGate program or you want update it,  download the latest version from our Webserver and install/replace it automatically by clicking the following link. Make sure that your PC is connected to the Internet and the Bluetooth link to the EV3 is established.</p>
  <p align="justify"><a href="http://www.aplu.ch/brickgate-install">Download BrickGate</a><br>  
  </p>
  <p align="justify"><font size="-1">The WebStart requires the installation of the JRE and the WebStart browser plugin. (Under Linux consult the appendix to see how to install them.) When started, a security warning is shown. The WebStar is signed by Comodo for ACE information technology AG, (Switzerland) and does not pose a risk.</font></p>
  <p align="justify">&nbsp;</p>
  <h3 align="justify">5 Write you first program and execute it in  direct and autonomous mode</h3>
</blockquote>
<ul>
  <li>Start <em>TigerJython</em> </li>
  <li>Click menu icon <em>Preferences, </em>select register card <em>Library</em> and check <em>Enable EV3-Download</em> and <em>Run after download</em></li>
</ul>
<p align="center"><img src="gifs/ev3tigerjython_en.png" alt="ev3tigerjython" width="248" height="408"></p>
<ul>
  <li>Close <em>TigerJython</em> and restart it. You now see an additional icon symbolizing the EV3 buttons in the icon bar</li>
  <li>Write a short program MyFirst using the EV3 gear object:</li>
</ul>
<blockquote>
  <p align="center"><img src="gifs/ev3myfirst_en.png" alt="ev3myfirst" width="480" height="480"></p>
</blockquote>
<ul>
  <li>Execute the Python script in <strong>direct mode</strong>: Just click the green <em>Run</em> icon. A dialog opens that requests the IP address of the EV3 brick. Accept the default value 10.0.1.1 by pressing OK. The remote PC sends commands via TCP/IP to the <em>BrickGate</em> server that pass them to the leJOS system. The EV3 plays a connect melody and the vehicle moves for 1 second. Then you hear the disconnect melody.<br>
    <br>
  </li>
  <li>Execute the Python script in <strong>autonomous mode</strong>: Click the <em>Download to EV3</em> icon. You see a confirmation message in the output window and the scripts starts automatically. The local script still communicates with the <em>BrickGate</em> server, but uses now a local (internal) link (localhost). Again the EV3 plays the connect melody, moves forward and plays the disconnect melody.</li>
</ul>
<blockquote>&nbsp;</blockquote>
<blockquote>
  <p align="center"><img src="gifs/ev3download_en.png" alt="ev3download" width="635" height="480"></p>
  <p>The script is now stored in the Brick's Linux file system (in /home/python/scripts) and you see it immediately in the the<em> BrickGate</em> menu. Move the arrow with the <em>Up-Down</em> buttons, so it point to the script name you want to execute. Then press the <em>Enter</em> button. The script executes again, even if the brick is disconnect from the PC.</p>
  <p align="center"><img src="gifs/ev3display.gif" alt="ev3inst" width="155" height="114"></p>
  <p>Because no error messages are shown in autonomous mode, you better test your script in direct mode first. But if a local script causes your EV3 to block or lasts too long, you may stop it  any time by pressing the <em>Down+Enter</em> key combination. This will stop the <em>BrickGate</em> server too and you must restart <em>BrickGate</em> (but not the EV3!) to execute another script.</p>
  <p>(If you want to explore your EV3 Linux operating system and use the Python interpreter (or Java) in a SSH shell, you find more information <a href="http://www.aplu.ch/home/ev3_inst.html#explorelinux">here</a>).</p>
  <p>&nbsp;</p>
  <h3><font size="-1">Appendix: Installation of the JRE and the WebStart browser plugin under Linux (Ubuntu)</font></h3>
  <p><font size="-1">In a terminal execute the following commands:</font></p>
  <table border="0" width="97%">
    <tbody>
      <tr>
        <td bgcolor="F0F0F5"><font size="-1"><strong>sudo add-apt-repository ppa:webupd8team/java <br>
          sudo apt-get update <br>
          sudo apt-get install oracle-java7-installer </strong></font></td>
      </tr>
    </tbody>
  </table>
  <p>&nbsp;</p>
  <p><a href="http://ch/aplu/docs/index_fr.html"><img src="gifs/home.png" alt="home" width="25" height="25"></a><br>
  </p>
</blockquote>
</body>
</html>